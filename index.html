<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logic Gate Game</title>
    <style>
        /* Basic CSS styling */
        body {
            font-family: Arial, sans-serif;
        }

        #sidebar {
            width: 200px;
            float: left;
            background-color: #f4f4f4;
            padding: 10px;
            border-right: 1px solid #ccc;
        }

        #sidebar ul {
            list-style-type: none;
            padding: 0;
        }

        #sidebar ul li {
            margin-bottom: 10px;
        }

        #sidebar a {
            text-decoration: none;
            color: #000;
            font-weight: bold;
        }

        #sidebar a:hover {
            color: #007BFF;
        }

        #content {
            margin-left: 220px;
            padding: 20px;
        }

        .hidden {
            display: none;
        }

        #timer {
            font-weight: bold;
            font-size: 1.2em;
        }

        button {
            padding: 10px 20px;
            margin: 10px;
            font-size: 1em;
        }

        h2 {
            color: #007BFF;
        }

        #settings-container,
        #game-interface,
        #results {
            margin-top: 20px;
        }

        #answer-buttons button {
            width: 100px;
        }

        #score-board ul {
            list-style-type: none;
            padding: 0;
        }

        #score-board ul li {
            margin-bottom: 5px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div id="sidebar">
        <button id="toggle-sidebar">Toggle Sidebar</button>
        <ul>
            <li><a href="#settings-container">Settings</a></li>
            <li><a href="#game-interface">Game</a></li>
            <li><a href="#score-board">Score Board</a></li>
        </ul>
    </div>

    <div id="content">
        <!-- Settings -->
        <div id="settings-container">
            <h2>Game Settings</h2>
            <label for="difficulty">Select Difficulty:</label>
            <select id="difficulty">
                <option value="Noob">Noob</option>
                <option value="Normal">Normal</option>
                <option value="Hard">Hard</option>
                <option value="Nightmare">Nightmare</option>
            </select>

            <br><br>

            <label for="numQuestions">Number of Questions:</label>
            <input type="range" id="numQuestions" min="5" max="20" value="10" oninput="updateNumQuestions(this.value)">
            <span id="numQuestionsDisplay">10</span>

            <br><br>

            <label for="timeLimit">Time Limit per Question:</label>
            <input type="range" id="timeLimit" min="5" max="30" value="10" oninput="updateTimeLimit(this.value)">
            <span id="timeLimitDisplay">10 seconds</span>

            <br><br>

            <button onclick="startGame()">Start Game</button>
        </div>

        <!-- Game Interface -->
        <div id="game-interface" class="hidden">
            <h2>Logic Gate Game</h2>
            <p id="timer">Time Remaining: 10 seconds</p>
            <p id="variables" class="hidden"></p>
            <p id="question" class="hidden"></p>

            <div id="answer-buttons" class="hidden">
                <button onclick="checkAnswer(1)">1</button>
                <button onclick="checkAnswer(0)">0</button>
            </div>
        </div>

        <!-- Game Results -->
        <div id="results" class="hidden">
            <h2>Game Results</h2>
            <p id="score"></p>
            <button onclick="startGame()">Play Again</button>
        </div>

        <!-- Score Board -->
        <div id="score-board" class="hidden">
            <h2>Score Board</h2>
            <ul id="score-list"></ul>
        </div>
    </div>

    <script>
        let scores = {
            Noob: 0,
            Normal: 0,
            Hard: 0,
            Nightmare: 0
        };

        const logicGates = ["AND", "OR", "XOR", "NAND", "NOR"];
        let currentQuestion;
        let variables = { A: 0, B: 0, C: 0, D: 0 };
        let timeRemaining;
        let timerInterval;
        let numQuestions = 10;
        let timeLimitPerQuestion = 10;
        let questionsAnswered = 0;
        let correctAnswers = 0;
        let incorrectAnswers = 0;
        let totalScore = 0;
        let difficultyLevel = 'Noob';

        document.querySelector('#toggle-sidebar').addEventListener('click', () => {
            document.getElementById('sidebar').classList.toggle('collapsed');
        });

        document.querySelectorAll('#sidebar a').forEach(link => {
            link.addEventListener('click', function (event) {
                event.preventDefault();
                const targetId = this.getAttribute('href').substring(1);

                document.querySelectorAll('#content > div').forEach(div => {
                    div.classList.add('hidden');
                });

                if (targetId === 'game') {
                    document.getElementById('settings-container').classList.remove('hidden');
                } else {
                    document.getElementById(targetId).classList.remove('hidden');
                }

                if (targetId === "score-board") {
                    updateScoreBoard();
                }
            });
        });

        function updateNumQuestions(value) {
            numQuestions = value;
            document.getElementById("numQuestionsDisplay").textContent = value;
        }

        function updateTimeLimit(value) {
            timeLimitPerQuestion = value;
            document.getElementById("timeLimitDisplay").textContent = `${value} seconds`;
        }

        function startGame() {
            difficultyLevel = document.getElementById('difficulty').value;

            // Reset game interface and scores
            document.getElementById('settings-container').classList.add('hidden');
            document.getElementById('game-interface').classList.remove('hidden');

            questionsAnswered = 0;
            correctAnswers = 0;
            incorrectAnswers = 0;
            totalScore = 0;

            generateVariables();
            generateQuestion();
        }

        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);  // Clear any previous interval

            timeRemaining = timeLimitPerQuestion;
            updateTimerDisplay();
            timerInterval = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();

                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    incorrectAnswers++;
                    adjustScore(false);
                    questionsAnswered++;
                    if (questionsAnswered < numQuestions) {
                        generateVariables();
                        generateQuestion();
                    } else {
                        endGame();
                    }
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            document.getElementById("timer").textContent = `Time Remaining: ${timeRemaining} seconds`;
        }

        function generateVariables() {
            const values = Array.from({ length: 4 }, () => Math.round(Math.random()));
            variables = { A: values[0], B: values[1], C: values[2], D: values[3] };

            document.getElementById('variables').innerHTML = `A = ${variables.A}, B = ${variables.B}, C = ${variables.C}, D = ${variables.D}`;
            document.getElementById('variables').classList.remove('hidden');
        }

        function generateQuestion() {
            let numGates;
            switch (difficultyLevel) {
                case 'Noob':
                    numGates = 4;
                    break;
                case 'Normal':
                    numGates = 6;
                    break;
                case 'Hard':
                    numGates = 8;
                    break;
                case 'Nightmare':
                    numGates = 10;
                    break;
            }

            const variablesOrder = ['A', 'B', 'C', 'D'].sort(() => Math.random() - 0.5);
            const inputValues = variablesOrder.map(v => variables[v]);

            const gates = Array.from({ length: numGates }, () => logicGates[Math.floor(Math.random() * logicGates.length)]);

            let result = inputValues[0];
            let questionText = `(${variablesOrder[0]})`;

            for (let i = 0; i < numGates; i++) {
                result = calculateLogicGate(gates[i], [result, inputValues[(i + 1) % inputValues.length]]);
                questionText += ` ${gates[i]} (${variablesOrder[(i + 1) % variablesOrder.length]}) `;
                if (i < numGates - 1) {
                    questionText += `----> `;
                }
            }

            currentQuestion = { gates, result };

            document.getElementById("question").innerHTML = `${questionText}`;
            document.getElementById('question').classList.remove('hidden');
            document.getElementById('answer-buttons').classList.remove('hidden');

            startTimer();
        }

        function calculateLogicGate(gate, inputs) {
            switch (gate) {
                case "AND":
                    return inputs[0] && inputs[1] ? 1 : 0;
                case "OR":
                    return inputs[0] || inputs[1] ? 1 : 0;
                case "XOR":
                    return inputs[0] !== inputs[1] ? 1 : 0;
                case "NAND":
                    return !(inputs[0] && inputs[1]) ? 1 : 0;
                case "NOR":
                    return !(inputs[0] || inputs[1]) ? 1 : 0;
            }
        }

        function checkAnswer(answer) {
            clearInterval(timerInterval); // Ensure the timer is stopped
            if (currentQuestion.result === answer) {
                correctAnswers++;
                adjustScore(true);
            } else {
                incorrectAnswers++;
                adjustScore(false);
            }
            questionsAnswered++;

            if (questionsAnswered < numQuestions) {
                generateVariables();
                generateQuestion();
            } else {
                endGame();
            }
        }

        function adjustScore(isCorrect) {
            let baseScore = 100;
            let timeFactor = 60 / timeLimitPerQuestion;

            if (isCorrect) {
                totalScore += baseScore * timeFactor;
            } else {
                totalScore -= baseScore * timeFactor;
            }
        }

        function endGame() {
            clearInterval(timerInterval);
            scores[difficultyLevel] = Math.max(scores[difficultyLevel], totalScore);
            document.getElementById('game-interface').classList.add('hidden');
            document.getElementById('results').classList.remove('hidden');
            document.getElementById('score').textContent = `Correct: ${correctAnswers}, Incorrect: ${incorrectAnswers}, Total Score: ${totalScore}`;
        }

        function updateScoreBoard() {
            const scoreList = document.getElementById('score-list');
            scoreList.innerHTML = `
                <li>Noob: ${scores.Noob}</li>
                <li>Normal: ${scores.Normal}</li>
                <li>Hard: ${scores.Hard}</li>
                <li>Nightmare: ${scores.Nightmare}</li>
            `;
        }
    </script>
</body>
</html>
